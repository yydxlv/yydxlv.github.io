<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>lua学习 | 你还想活吗</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="lua基础一、注释单行注释：两个破折号多行注释：[[ … ]]
二、变量和流程控制所有的数字类型都是double
num=42
字符串是Immutable的，和python一样
s = &apos;walternate&apos;
t = &quot;double-quotes are also fine&quot;
u = [[ Double brackets
          start and end
          mul">
<meta property="og:type" content="article">
<meta property="og:title" content="lua学习">
<meta property="og:url" content="http://yoursite.com/2015/11/26/lua学习/index.html">
<meta property="og:site_name" content="你还想活吗">
<meta property="og:description" content="lua基础一、注释单行注释：两个破折号多行注释：[[ … ]]
二、变量和流程控制所有的数字类型都是double
num=42
字符串是Immutable的，和python一样
s = &apos;walternate&apos;
t = &quot;double-quotes are also fine&quot;
u = [[ Double brackets
          start and end
          mul">
<meta property="og:updated_time" content="2015-11-26T14:23:31.475Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="lua学习">
<meta name="twitter:description" content="lua基础一、注释单行注释：两个破折号多行注释：[[ … ]]
二、变量和流程控制所有的数字类型都是double
num=42
字符串是Immutable的，和python一样
s = &apos;walternate&apos;
t = &quot;double-quotes are also fine&quot;
u = [[ Double brackets
          start and end
          mul">
  
    <link rel="alternative" href="/atom.xml" title="你还想活吗" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://yydxlv.github.io/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">yydxlv</a></h1>
		</hgroup>

		
		<p class="header-subtitle">有多少和我一起走进这个尘世的人们已经离去了</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/yydxlv" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/yydxlv/home?wvr=5" title="weibo">weibo</a>
					        
								<a class="linkedin" target="_blank" href="http://www.linkedin.com/profile/view?id=AAIAABi1GS4BDfnHHUf8YO_simisETkrafdtydM&trk=nav_responsive_tab_profile_pic" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/TimeMap/" style="font-size: 10px;">TimeMap</a> <a href="/tags/lua基础/" style="font-size: 10px;">lua基础</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://librap.github.io/">Simba&#39;blog</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">yydxlv</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://yydxlv.github.io/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">yydxlv</h1>
			</hgroup>
			
			<p class="header-subtitle">有多少和我一起走进这个尘世的人们已经离去了</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/yydxlv" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/yydxlv/home?wvr=5" title="weibo">weibo</a>
			        
						<a class="linkedin" target="_blank" href="http://www.linkedin.com/profile/view?id=AAIAABi1GS4BDfnHHUf8YO_simisETkrafdtydM&trk=nav_responsive_tab_profile_pic" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-lua学习" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/26/lua学习/" class="article-date">
  	<time datetime="2015-11-26T08:07:49.000Z" itemprop="datePublished">2015-11-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      lua学习
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/lua基础/">lua基础</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Machine-Learning/">Machine Learning</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="lua基础">lua基础</h1><h2 id="一、注释">一、注释</h2><p>单行注释：两个破折号<br>多行注释：[[ … ]]</p>
<h2 id="二、变量和流程控制">二、变量和流程控制</h2><p>所有的数字类型都是double</p>
<pre><code>num=<span class="number">42</span>
</code></pre><p>字符串是Immutable的，和python一样</p>
<pre><code>s = <span class="string">'walternate'</span>
t = <span class="string">"double-quotes are also fine"</span>
u = <span class="string">[[ Double brackets
          start and end
          multi-line strings.]]</span>
</code></pre><p>lua有垃圾回收机制，t是undefined</p>
<pre><code><span class="literal">t</span> = <span class="literal">nil</span>
</code></pre><p>语句块用关键字do/end标示</p>
<pre><code><span class="keyword">while</span> <span class="built_in">num</span> &lt; <span class="number">50</span> <span class="built_in">do</span>
    <span class="built_in">num</span> = <span class="built_in">num</span> + <span class="number">1</span>       <span class="comment">-- 没有 ++ 或 += 操作符.</span>
<span class="function"><span class="keyword">end</span>

<span class="title">If</span> 语句:</span>
    <span class="keyword">if</span> <span class="built_in">num</span> &gt; <span class="number">40</span> <span class="keyword">then</span>
          print(<span class="string">'over 40'</span>)
    elseif s ~= <span class="string">'walternate'</span> <span class="keyword">then</span>  <span class="comment">-- ~= 是不等号.</span>
<span class="comment">-- 等号是== 对字符串也适用.</span>
      io.<span class="built_in">write</span>(<span class="string">'not over 40\n'</span>)  <span class="comment">-- 默认输出到stdout.</span>
    <span class="keyword">else</span>
  <span class="comment">-- 变量默认是全局的.</span>
      thisIsGlobal = <span class="number">5</span>  <span class="comment">-- 常用Camel样式.</span>

  <span class="comment">-- 局部变量如下定义:</span>
      <span class="built_in">local</span> <span class="built_in">line</span> = io.<span class="built_in">read</span>()  <span class="comment">-- 读取下一个stdin 行.</span>

  <span class="comment">-- 字符串连接使用 .. 操作符:</span>
      print(<span class="string">'Winter is coming, '</span> .. <span class="built_in">line</span>)
    <span class="function"><span class="keyword">end</span>

未定义的变量返回<span class="title">nil</span></span>
    foo = anUnknownVariable  <span class="comment">-- Now foo = nil.</span>
    aBoolValue = <span class="constant">false</span>
<span class="comment">-- 只有nil 和 false 是 falsy; 0 和 '' 是 true!</span>
    <span class="keyword">if</span> <span class="operator">not</span> aBoolValue <span class="keyword">then</span> print(<span class="string">'twas false'</span>) <span class="function"><span class="keyword">end</span>
-- '<span class="title">or</span>' <span class="title">and</span> '<span class="title">and</span>' 是短路的.</span>
<span class="comment">-- 这和 C/js中的 a?b:c 相似:</span>
    ans = aBoolValue <span class="operator">and</span> <span class="string">'yes'</span> <span class="operator">or</span> <span class="string">'no'</span>  <span class="comment">--&gt; 'no'</span>

    karlSum = <span class="number">0</span>
    <span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">100</span> <span class="built_in">do</span>  <span class="comment">-- 范围是闭区间.</span>
       karlSum = karlSum + i
    <span class="function"><span class="keyword">end</span>

-- 用 "<span class="title">100</span>, <span class="title">1</span>, -<span class="title">1</span>" 作为区间来递减:</span>
    fredSum = <span class="number">0</span>
    <span class="keyword">for</span> j = <span class="number">100</span>, <span class="number">1</span>, -<span class="number">1</span> <span class="built_in">do</span> fredSum = fredSum + j <span class="function"><span class="keyword">end</span>

-- 总体上, 区间是 <span class="title">begin</span>, <span class="title">end</span>[, <span class="title">step</span>].</span>

<span class="comment">-- 另一种循环结构:</span>
    <span class="keyword">repeat</span>
      print(<span class="string">'the way of the future'</span>)
      <span class="built_in">num</span> = <span class="built_in">num</span> - <span class="number">1</span>
    <span class="keyword">until</span> <span class="built_in">num</span> == <span class="number">0</span>
</code></pre><h2 id="三、函数">三、函数</h2><pre><code><span class="function"><span class="keyword">function</span> <span class="title">fib</span><span class="params">(n)</span></span>
  <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">then</span> <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">end</span>
  <span class="keyword">return</span> fib(n - <span class="number">2</span>) + fib(n - <span class="number">1</span>)
<span class="keyword">end</span>

<span class="comment">-- 也可返回闭包和匿名函数:</span>
<span class="function"><span class="keyword">function</span> <span class="title">adder</span><span class="params">(x)</span></span>
  <span class="comment">-- 当adder被调用时，返回函数就被创建，并且保存有x的值：</span>
  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(y)</span></span> <span class="keyword">return</span> x + y <span class="keyword">end</span>
<span class="keyword">end</span>
a1 = adder(<span class="number">9</span>)
a2 = adder(<span class="number">36</span>)
<span class="built_in">print</span>(a1(<span class="number">16</span>))  <span class="comment">--&gt; 25</span>
<span class="built_in">print</span>(a2(<span class="number">64</span>))  <span class="comment">--&gt; 100</span>

x, y, z = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>
<span class="comment">-- 赋值后 x = 1, y = 2, z = 3, 但 4 被丢弃了.</span>

<span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">(a, b, c)</span></span>
  <span class="built_in">print</span>(a, b, c)
  <span class="keyword">return</span> <span class="number">4</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">42</span>
<span class="keyword">end</span>

x, y = bar(<span class="string">'zaphod'</span>)  <span class="comment">--&gt; prints "zaphod  nil nil"</span>
<span class="comment">-- 现在 x = 4, y = 8, 值 15..42 被丢弃了.</span>

<span class="comment">-- 函数是一等公民, 可以是 local/global.</span>
<span class="comment">-- 下面是等价的:</span>
<span class="function"><span class="keyword">function</span> <span class="title">f</span><span class="params">(x)</span></span> <span class="keyword">return</span> x * x <span class="keyword">end</span>
f = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span></span> <span class="keyword">return</span> x * x <span class="keyword">end</span>

<span class="comment">-- 下面也是等价的:</span>
<span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">g</span><span class="params">(x)</span></span> <span class="keyword">return</span> <span class="built_in">math</span>.sin(x) <span class="keyword">end</span>
<span class="keyword">local</span> g; g  = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span></span> <span class="keyword">return</span> <span class="built_in">math</span>.sin(x) <span class="keyword">end</span>    

<span class="comment">-- 调用只有一个字符串的参数，不需要括号:</span>
<span class="built_in">print</span> <span class="string">'hello'</span>  <span class="comment">-- Works fine.</span>
</code></pre><h2 id="四、表">四、表</h2><p>Tables ： 哈希查找的关联数组，和dictionaries、map类似，是lua仅有的复合数据结构。</p>
<p>– Dict的的键默认是字符串的<br>    t = {key1 = ‘value1’, key2 = false}<br>    print(t.key1)  – 输出 ‘value1’.<br>    t.newKey = {}  – 添加一个新的 key/value 对.<br>    t.key2 = nil   – 从table中移除 key2.</p>
<pre><code>表常用的的键一般是数字或者字符串
u = {[<span class="string">'@!#'</span>] = <span class="string">'qbert'</span>, [{}] = <span class="number">1729</span>, [<span class="number">6.28</span>] = <span class="string">'tau'</span>}
<span class="built_in">print</span>(u[<span class="number">6.28</span>])  <span class="comment">-- 输出"tau"</span>
a = u[<span class="string">'@!#'</span>]    <span class="comment">-- a = 'qbert'.</span>
b = u[{}]     <span class="comment">-- 误认为是1729, 其实是 nil。</span>

<span class="keyword">for</span> key, val <span class="keyword">in</span> <span class="built_in">pairs</span>(u) <span class="keyword">do</span>  <span class="comment">-- 表迭代.</span>
  <span class="built_in">print</span>(key, val)
<span class="keyword">end</span>

<span class="comment">-- 调用一个 one-table-param 的函数不需要括号</span>
<span class="function"><span class="keyword">function</span> <span class="title">h</span><span class="params">(x)</span></span> <span class="built_in">print</span>(x.key1) <span class="keyword">end</span>
h{key1 = <span class="string">'Sonmi~451'</span>}  <span class="comment">-- Prints 'Sonmi~451'.</span>

<span class="comment">-- _G 是一个全局的特殊表.</span>
<span class="built_in">print</span>(<span class="built_in">_G</span>[<span class="string">'_G'</span>] == <span class="built_in">_G</span>)  <span class="comment">-- 输出 'true'.</span>

<span class="comment">-- 把 tables 用作 lists / arrays:</span>

<span class="comment">-- List 的键默认是整数，键是连续的整数，其实还是table:</span>
v = {<span class="string">'value1'</span>, <span class="string">'value2'</span>, <span class="number">1.21</span>, <span class="string">'gigawatts'</span>}
<span class="keyword">for</span> i = <span class="number">1</span>, #v <span class="keyword">do</span>  <span class="comment">-- #v 是列表v的长度.</span>
  <span class="built_in">print</span>(v[i])     <span class="comment">-- 第一个索引是1</span>
<span class="keyword">end</span>
</code></pre><p>4.1. 元表和元方法.</p>
<p>–元表给予表操作符重载的特性，类似js的prototype的特性。</p>
<pre><code>f1 = {<span class="operator">a</span> = <span class="number">1</span>, b = <span class="number">2</span>}  <span class="comment">-- 表示分数 a/b.</span>
f2 = {<span class="operator">a</span> = <span class="number">2</span>, b = <span class="number">3</span>}

<span class="comment">-- 但是下面这样会报错:</span>
<span class="comment">-- s = f1 + f2</span>

metafraction = {}
<span class="function"><span class="keyword">function</span> <span class="title">metafraction</span>.<span class="title">__add</span>(<span class="title">f1</span>, <span class="title">f2</span>)</span>
  <span class="built_in">sum</span> = {}
  <span class="built_in">sum</span>.b = f1.b * f2.b
  <span class="built_in">sum</span>.<span class="operator">a</span> = f1.<span class="operator">a</span> * f2.b + f2.<span class="operator">a</span> * f1.b
  <span class="constant">return</span> <span class="built_in">sum</span>
<span class="function"><span class="keyword">end</span>

<span class="title">setmetatable</span>(<span class="title">f1</span>, <span class="title">metafraction</span>)</span>
setmetatable(f2, metafraction)

s = f1 + f2  

<span class="comment">-- 元表上的 __index 重载 . 查找:</span>
defaultFavs = {animal = <span class="string">'gru'</span>, food = <span class="string">'donuts'</span>}
myFavs = {food = <span class="string">'pizza'</span>}
setmetatable(myFavs, {__index = defaultFavs})
eatenBy = myFavs.animal  <span class="comment">-- 可行! thanks, metatable</span>

一个__index值也可以是个函数(tbl, key)，有利于个性化查找。
像__index,<span class="built_in">add</span>, .. 都是元方法，下面是一个全表，这里 <span class="operator">a</span>是一个有metamethod的表

<span class="comment">-- __add(a, b)                     for a + b</span>
<span class="comment">-- __sub(a, b)                     for a - b</span>
<span class="comment">-- __mul(a, b)                     for a * b</span>
<span class="comment">-- __div(a, b)                     for a / b</span>
<span class="comment">-- __mod(a, b)                     for a % b</span>
<span class="comment">-- __pow(a, b)                     for a ^ b</span>
<span class="comment">-- __unm(a)                        for -a</span>
<span class="comment">-- __concat(a, b)                  for a .. b</span>
<span class="comment">-- __len(a)                        for #a</span>
<span class="comment">-- __eq(a, b)                      for a == b</span>
<span class="comment">-- __lt(a, b)                      for a &lt; b</span>
<span class="comment">-- __le(a, b)                      for a &lt;= b</span>
<span class="comment">-- __index(a, b)  &lt;fn or a table&gt;  for a.b</span>
<span class="comment">-- __newindex(a, b, c)             for a.b = c</span>
<span class="comment">-- __call(a, ...)                  for a(...)</span>
</code></pre><p>4.2. 类风格的表与继承 </p>
<p>类不是内置的，有多种可以使用tables和metatables的方法</p>
<pre><code>Dog = {}                                   <span class="comment">-- 1.</span>

<span class="function"><span class="keyword">function</span> <span class="title">Dog:new</span><span class="params">()</span></span>                         <span class="comment">-- 2.</span>
  newObj = {sound = <span class="string">'woof'</span>}                <span class="comment">-- 3.</span>
  self.__index = self                      <span class="comment">-- 4.</span>
  <span class="keyword">return</span> <span class="built_in">setmetatable</span>(newObj, self)        <span class="comment">-- 5.</span>
<span class="keyword">end</span>

<span class="function"><span class="keyword">function</span> <span class="title">Dog:makeSound</span><span class="params">()</span></span>                   <span class="comment">-- 6.</span>
  <span class="built_in">print</span>(<span class="string">'I say '</span> .. self.sound)
<span class="keyword">end</span>

mrDog = Dog:new()                          <span class="comment">-- 7.</span>
mrDog:makeSound()  <span class="comment">-- 'I say woof'         -- 8.</span>
</code></pre><p>–1. Dog 像是一个class，它实际是一个表。</p>
<p>–2. 函数 tablename：fn(…) 和函数tablename.fn(self,…)一样，： 仅仅添加第一个名为self的参数。</p>
<p>–3. newObj是类Dog的实例。</p>
<p>–4. self就是被继承的类，但是继承可以改变self的值，这里是Dog，当我们设置newObj’s metatable 和 self’s __index to self时，newObj 才能使用self’s 函数。</p>
<p>–5. setmetatable 返回它的第一个参数</p>
<p>–6. 这时，self是一个实例而不是一个类。</p>
<p>–7. 和Dog.new(Dog)一样。</p>
<p>–8. 和mrDog.makeSound(mrDog)一样; 此时 self = mrDog.</p>
<p>继承的例子：</p>
<pre><code>LoudDog = Dog:new()                           <span class="comment">-- 1.    </span>
<span class="function"><span class="keyword">function</span> <span class="title">LoudDog:makeSound</span><span class="params">()</span></span>
  s = self.sound .. <span class="string">' '</span>                       <span class="comment">-- 2.</span>
  <span class="built_in">print</span>(s .. s .. s)
<span class="keyword">end</span>    
seymour = LoudDog:new()                       <span class="comment">-- 3.</span>
seymour:makeSound()  <span class="comment">-- 'woof woof woof'      -- 4.</span>
</code></pre><p>– 1. LoudDog 继承了 Dog’s 的方法和变量。</p>
<p>– 2. self 有一个来自于new()的 ‘sound’键。</p>
<p>– 3. 和LoudDog.new(LoudDog)一样, 由于LoudDog没有‘new’键，将被转换为 Dog.new(LoudDog),但是它的 metatable 拥有 <strong>index = Dog。<br>结论：seymour的 metatable是LoudDog，LoudDog.</strong>index = LoudDog. 所以 seymour.key = seymour.key, LoudDog.key, Dog.key, 任何第一个含有给定键的表。</p>
<p>– 4. ‘makeSound’ key 包含在LoudDog;这和LoudDog.makeSound(seymour)一样.</p>
<p>– 如果有需要, 一个子类的 new() 可以和基类的一样:</p>
<pre><code><span class="function"><span class="keyword">function</span> <span class="title">LoudDog</span>:</span><span class="keyword">new</span>()
  newObj = {}
  -- set up newObj
  <span class="variable">self</span>.__index = <span class="variable">self</span>
  <span class="keyword">return</span> setmetatable(newObj, <span class="variable">self</span>)
<span class="keyword">end</span>
</code></pre><h1 id="五、模块">五、模块</h1><p>– 假设文件mod.lua 像如下所示:</p>
<pre><code><span class="keyword">local</span> M = {}
<span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">sayMyName</span><span class="params">()</span></span>
  <span class="built_in">print</span>(<span class="string">'Hrunkner'</span>)
<span class="keyword">end</span>

<span class="function"><span class="keyword">function</span> <span class="title">M.sayHello</span><span class="params">()</span></span>
  <span class="built_in">print</span>(<span class="string">'Why hello there'</span>)
  sayMyName()
<span class="keyword">end</span>

<span class="keyword">return</span> M

<span class="comment">-- 另一个文件可以使用mod.lua's 的函数:</span>
<span class="keyword">local</span> mod = <span class="built_in">require</span>(<span class="string">'mod'</span>)  <span class="comment">-- 运行文件 mod.lua.</span>

<span class="comment">-- require 是 引用和包含 modules 的标准方法.</span>
<span class="comment">-- require 其实像下面这样工作:  （没有缓存的）   </span>
<span class="keyword">local</span> mod = (<span class="function"><span class="keyword">function</span> <span class="params">()</span></span> 
            &lt;contents of mod.lua&gt; 
            <span class="keyword">end</span>)()
<span class="comment">-- mod.lua 像是一个函数体,所以 mod.lua内的局部变量对外不可见</span>

<span class="comment">-- 因为在mod.lua里面，这里的mod = M :</span>
mod.sayHello()   <span class="comment">-- Says hello to Hrunkner.</span>

<span class="comment">-- 错误; sayMyName 只存在于 mod.lua:</span>
mod.sayMyName()  <span class="comment">-- error</span>

<span class="comment">-- require's 的返回值是经过缓存的，所以一个文件最多运行一次，无论require多少次。</span>
<span class="comment">-- 假设 mod2.lua 包含 "print('Hi!')".</span>
<span class="keyword">local</span> a = <span class="built_in">require</span>(<span class="string">'mod2'</span>)  <span class="comment">-- 输出 Hi!</span>
<span class="keyword">local</span> b = <span class="built_in">require</span>(<span class="string">'mod2'</span>)  <span class="comment">-- 无输出; a=b.</span>

<span class="comment">-- dofile 就像无缓存的 require:</span>
<span class="built_in">dofile</span>(<span class="string">'mod2.lua'</span>)  <span class="comment">--&gt; Hi!</span>
<span class="built_in">dofile</span>(<span class="string">'mod2.lua'</span>)  <span class="comment">--&gt; Hi! (runs it again)</span>

<span class="comment">-- loadfile 装载一个lua 文件，但并不立即运行。</span>
f = <span class="built_in">loadfile</span>(<span class="string">'mod2.lua'</span>)  <span class="comment">-- 调用 f() 来运行.</span>

<span class="comment">-- loadstring 相当于strings版的loadfile.</span>
g = <span class="built_in">loadstring</span>(<span class="string">'print(343)'</span>)  <span class="comment">-- 返回一个函数.</span>
g()                            <span class="comment">-- 输出343; 此前无输出.</span>
</code></pre><h1 id="参考：">参考：</h1><p><a href="http://tylerneylon.com/a/learn-lua/" target="_blank" rel="external">15分钟学会lua</a></p>
<p><a href="http://nova-fusion.com/2012/08/27/lua-for-programmers-part-1/" target="_blank" rel="external">Lua编程(Part 1)：基本语法</a></p>
<p><a href="http://nova-fusion.com/2012/08/27/lua-for-programmers-part-2/" target="_blank" rel="external">Lua编程(Part 2)：数据和标准库</a></p>
<p><a href="http://nova-fusion.com/2012/09/07/lua-for-programmers-part-3/" target="_blank" rel="external">Lua编程(Part 3)：高级概念</a></p>
<p><a href="http://nova-fusion.com/2012/09/09/lua-for-programmers-part-4/" target="_blank" rel="external">Lua编程(Part 4)：技巧</a></p>
<p><a href="http://love2d.org/" target="_blank" rel="external">love 2D游戏引擎</a></p>
<p><a href="http://www.lua.org/pil/contents.html" target="_blank" rel="external">lua官方学习文档</a></p>
<p><a href="https://apaszke.github.io/torch-internals.html" target="_blank" rel="external">A quick tour of Torch internals</a></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2015/11/24/Markdown语法学习/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Markdown 语法学习</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="lua学习" data-title="lua学习" data-url="http://yoursite.com/2015/11/26/lua学习/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 yydxlv
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>